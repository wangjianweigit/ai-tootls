# Excel半结构化数据解析工具

## 📖 简介

Excel半结构化数据解析工具是一个基于AI大模型的智能数据提取系统，能够从Excel表格中的非结构化或半结构化文本中自动提取出结构化数据。

### 核心功能

- 🤖 **AI智能提取**：基于大语言模型，准确理解文本语义
- 📊 **批量处理**：支持大批量数据的高效处理
- 🔄 **断点续传**：支持任务中断后从检查点恢复
- 📈 **实时监控**：可视化任务进度和状态管理
- 🎯 **灵活配置**：自定义提取规则和字段映射
- 🚀 **并行处理**：支持多线程并行提高处理速度

### 适用场景

- 📋 医疗病历数据结构化
- 📝 客户反馈信息提取
- 📑 报告摘要关键信息抽取
- 💬 问卷调查自由文本分析
- 📰 新闻文章要素提取
- 📧 邮件内容关键信息提取

## 🚀 快速开始

### 1. 启动服务

```bash
cd /Users/jacking/tools/tools/excelParseTools
./start.sh
```

### 2. 访问界面

打开浏览器访问：`http://localhost:5001/excel-tools/`

### 3. 体验示例

我们提供了包含50条数据的完整示例，帮助你快速上手：

- **5分钟快速体验**：参考 `QUICK_START.md`
- **完整最佳实践**：参考 `BEST_PRACTICE.md`

## 📚 文档导航

### 新手入门
1. [快速开始指南](QUICK_START.md) - 5分钟快速体验
2. [最佳实践指南](BEST_PRACTICE.md) - 详细的使用教程和技巧

### 示例文件
- `excel_parser_data/imports/best_practice_sample_50.xlsx` - 包含50条医疗病例的示例数据

### 技术文档
- `config.py` - 配置文件说明
- `web_interface.py` - Web API接口
- `excel_structured_parser.py` - 核心解析引擎

## 🎯 基本使用流程

### 步骤1：上传文件
- 支持 `.xlsx` 和 `.xls` 格式
- 可选择索引列（推荐使用唯一标识列）

### 步骤2：配置规则
- **源列**：选择包含原始文本的列
- **目标列**：定义要提取的字段名称
- **提示词**：描述如何提取数据

### 步骤3：设置参数
- **线程数**：1-8，控制并行处理速度
- **检查点间隔**：控制保存频率

### 步骤4：启动任务
- 后台异步处理
- 实时查看进度

### 步骤5：下载结果
- 任务完成后下载处理后的Excel文件
- 包含原始数据和提取的结构化字段

## 💡 核心特性

### 智能提取
基于先进的大语言模型，能够：
- 理解自然语言描述
- 识别复杂的数据模式
- 处理多种格式的文本

### 灵活配置
- 自定义提取规则
- 支持一对多字段映射
- 可配置多个独立规则并行处理

### 高效处理
- 多线程并行处理
- 批量API调用优化
- 智能缓存机制

### 可靠性保障
- 检查点自动保存
- 断点续传支持
- 错误重试机制
- 详细的日志记录

## 🔧 配置说明

### 环境要求
- Python 3.8+
- Flask
- pandas
- openpyxl
- requests

### API配置
编辑 `config.py` 配置大模型API：
```python
MOONSHOT_API_KEY = "your-api-key"
MOONSHOT_BASE_URL = "https://api.moonshot.cn/v1/chat/completions"
```

### 目录结构
```
excelParseTools/
├── excel_parser_data/
│   ├── imports/          # 导入的Excel文件
│   ├── exports/          # 处理结果文件
│   └── temp/            # 临时文件和检查点
├── templates/           # Web界面模板
├── static/             # 静态资源
├── logs/               # 日志文件
├── config.py           # 配置文件
├── web_interface.py    # Web服务
├── excel_structured_parser.py  # 核心引擎
└── start.sh           # 启动脚本
```

## 📊 性能参考

### 处理速度
- 单条记录：3-5秒（取决于文本复杂度和API响应）
- 50条记录（2线程）：约5-8分钟
- 100条记录（4线程）：约10-15分钟

### 准确率
- 简单提取（姓名、日期等）：>98%
- 中等复杂度（数值、列表）：>95%
- 复杂推理：>90%

## 🎓 最佳实践建议

### 提示词编写
1. **明确具体**：清楚说明要提取什么，在哪里找
2. **格式规范**：明确输出格式（纯数字、带单位、分隔符等）
3. **异常处理**：说明找不到数据时如何处理
4. **提供示例**：帮助AI理解预期输出

### 规则设计
1. **按类型分组**：相关字段放在同一规则中
2. **独立性原则**：每个规则独立，互不依赖
3. **从简到繁**：先提取简单字段，再处理复杂逻辑

### 性能优化
1. **合理设置线程数**：从1开始逐步增加
2. **适当的检查点**：50-100条一次为佳
3. **批量处理**：尽量在一个规则中处理多个相关字段
4. **提示词精简**：减少不必要的文字

## ⚠️ 注意事项

### 数据安全
- 敏感数据请脱敏后处理
- 及时删除临时文件
- 遵守数据保护法规

### API使用
- 注意API调用限制
- 监控使用量和成本
- 合理设置重试策略

### 结果验证
- 不要100%依赖AI结果
- 关键数据需人工抽检
- 建立质量评估流程

## 🔗 相关链接

- [快速开始](QUICK_START.md) - 5分钟体验
- [最佳实践](BEST_PRACTICE.md) - 详细教程
- [任务管理](http://localhost:5001/excel-tools/tasks) - 查看所有任务

## 📞 技术支持

如遇问题，请检查：
1. 日志文件：`excel_parser.log`
2. 任务状态：访问任务管理页面
3. 配置文件：确认API密钥等配置正确

## 🔄 更新日志

### v1.0.0 (2024-10-15)
- ✨ 初始版本发布
- ✨ 支持基本的数据提取功能
- ✨ 提供Web界面操作
- ✨ 支持断点续传
- ✨ 添加任务管理功能
- 📝 提供完整的最佳实践指南

## 📄 许可证

本项目仅供内部使用。

---

**开始你的数据解析之旅吧！** 🚀

